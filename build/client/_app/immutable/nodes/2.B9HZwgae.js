import{t as N,h as Ce,a as w,r as He,e as C,s as ae,b as de}from"../chunks/BVLX1rLE.js";import{i as Pe}from"../chunks/BLm8SxSP.js";import{s as he,h as $,O as Ue,P as Oe,a as qe,b as Fe,j as a,M as Ve,c as Ye,r as ye,d as pe,g as ne,Q as Le,e as we,f as Ae,p as Xe,R as De,S as Je,n as Z,T as xe,V as me,W as Ee,X as Ke,Y as Qe,Z as We,_ as je,a0 as Ge,a1 as $e,a2 as ea,a3 as aa,a4 as ta,i as la,J as ra,K as oe,k as sa,$ as ia,l as o,o as f,q as u,m as i,t as G,u as na,a5 as va}from"../chunks/D_P7J2Hz.js";import{i as H}from"../chunks/y0faoB-u.js";import{r as ze,b as be}from"../chunks/BaPMyU2t.js";import{f as da,p as oa,u as ca,d as ua}from"../chunks/Cq41QnU_.js";function fa(_,l,e,h){for(var m=[],p=l.length,n=0;n<p;n++)We(l[n].e,m,!0);var x=p>0&&m.length===0&&e!==null;if(x){var g=e.parentNode;je(g),g.append(e),h.clear(),Q(_,l[0].prev,l[p-1].next)}Ge(m,()=>{for(var E=0;E<p;E++){var t=l[E];x||(h.delete(t.k),Q(_,t.prev,t.next)),$e(t.e,!x)}})}function _a(_,l,e,h,m,p=null){var n=_,x={flags:l,items:new Map,first:null};{var g=_;n=$?he(Ue(g)):g.appendChild(Oe())}$&&qe();var E=null,t=!1,b=Ve(()=>{var r=e();return Je(r)?r:r==null?[]:De(r)});Fe(()=>{var r=a(b),v=r.length;if(t&&v===0)return;t=v===0;let d=!1;if($){var X=n.data===Ye;X!==(v===0)&&(n=ye(),he(n),pe(!1),d=!0)}if($){for(var S=null,c,A=0;A<v;A++){if(ne.nodeType===8&&ne.data===Le){n=ne,d=!0,pe(!1);break}var J=r[A],F=h(J,A);c=Se(ne,x,S,null,J,F,A,m,l,e),x.items.set(F,c),S=c}v>0&&he(ye())}$||ha(r,x,n,m,l,h,e),p!==null&&(v===0?E?we(E):E=Ae(()=>p(n)):E!==null&&Xe(E,()=>{E=null})),d&&pe(!0),a(b)}),$&&(n=ne)}function ha(_,l,e,h,m,p,n){var x=_.length,g=l.items,E=l.first,t=E,b,r=null,v=[],d=[],X,S,c,A;for(A=0;A<x;A+=1){if(X=_[A],S=p(X,A),c=g.get(S),c===void 0){var J=t?t.e.nodes_start:e;r=Se(J,l,r,r===null?l.first:r.next,X,S,A,h,m,n),g.set(S,r),v=[],d=[],t=r.next;continue}if(pa(c,X,A),(c.e.f&me)!==0&&we(c.e),c!==t){if(b!==void 0&&b.has(c)){if(v.length<d.length){var F=d[0],M;r=F.prev;var ee=v[0],te=v[v.length-1];for(M=0;M<v.length;M+=1)Te(v[M],F,e);for(M=0;M<d.length;M+=1)b.delete(d[M]);Q(l,ee.prev,te.next),Q(l,r,ee),Q(l,te,F),t=F,r=te,A-=1,v=[],d=[]}else b.delete(c),Te(c,t,e),Q(l,c.prev,c.next),Q(l,c,r===null?l.first:r.next),Q(l,r,c),r=c;continue}for(v=[],d=[];t!==null&&t.k!==S;)(t.e.f&me)===0&&(b??(b=new Set)).add(t),d.push(t),t=t.next;if(t===null)continue;c=t}v.push(c),r=c,t=c.next}if(t!==null||b!==void 0){for(var le=b===void 0?[]:De(b);t!==null;)(t.e.f&me)===0&&le.push(t),t=t.next;var ce=le.length;if(ce>0){var ve=x===0?e:null;fa(l,le,ve,g)}}Ee.first=l.first&&l.first.e,Ee.last=r&&r.e}function pa(_,l,e,h){Qe(_.v,l),_.i=e}function Se(_,l,e,h,m,p,n,x,g,E){var t=(g&ea)!==0,b=(g&aa)===0,r=t?b?Z(m):xe(m):m,v=(g&Ke)===0?n:xe(n),d={i:v,v:r,k:p,a:null,e:null,prev:e,next:h};try{return d.e=Ae(()=>x(_,r,v,E),$),d.e.prev=e&&e.e,d.e.next=h&&h.e,e===null?l.first=d:(e.next=d,e.e.next=d.e),h!==null&&(h.prev=d,h.e.prev=d.e),d}finally{}}function Te(_,l,e){for(var h=_.next?_.next.e.nodes_start:e,m=l?l.e.nodes_start:e,p=_.e.nodes_start;p!==h;){var n=ta(p);m.before(p),p=n}}function Q(_,l,e){l===null?_.first=e:(l.next=e,l.e.next=e&&e.e),e!==null&&(e.prev=l,e.e.prev=l&&l.e)}var ma=N('<div class="loading svelte-112l7cd"><p>Načítání knih...</p></div>'),ba=N('<div class="error svelte-112l7cd"><p> </p> <button class="retry-button svelte-112l7cd">Zkusit znovu</button></div>'),ka=N('<div class="empty svelte-112l7cd"><p>Zatím zde nejsou žádné knihy.</p> <a href="/add" class="add-button svelte-112l7cd">Přidat první knihu</a></div>'),ga=N('<p class="author svelte-112l7cd"> </p>'),ya=N('<p class="note-content svelte-112l7cd"> </p>'),xa=N('<p class="note-empty svelte-112l7cd">Žádná poznámka</p>'),Ea=N('<div class="book-card svelte-112l7cd"><h3 class="svelte-112l7cd"> </h3> <!> <div class="note svelte-112l7cd"><!></div> <div class="book-actions svelte-112l7cd"><button class="edit-button svelte-112l7cd">Upravit</button> <button class="delete-button svelte-112l7cd">Smazat</button></div></div>'),za=N('<div class="bottom-add-link svelte-112l7cd"><a href="/add" class="add-button svelte-112l7cd">Přidat novou knihu</a></div>'),Ta=N('<a href="/add" class="add-button svelte-112l7cd">Přidat novou knihu</a> <div class="books-list svelte-112l7cd"></div> <!>',1),wa=N('<div class="error-message svelte-112l7cd"> </div>'),Aa=N('<div class="modal-backdrop svelte-112l7cd" role="button" tabindex="0" aria-label="Zavřít úpravu knihy"></div> <div class="modal svelte-112l7cd"><h3 class="svelte-112l7cd">Upravit knihu</h3> <!> <form><div class="form-group svelte-112l7cd"><label for="edit-title" class="svelte-112l7cd">Název knihy *</label> <input type="text" id="edit-title" placeholder="Zadejte název knihy" required class="svelte-112l7cd"></div> <div class="form-group svelte-112l7cd"><label for="edit-author" class="svelte-112l7cd">Autor</label> <input type="text" id="edit-author" placeholder="Zadejte jméno autora (nepovinné)" class="svelte-112l7cd"></div> <div class="form-group svelte-112l7cd"><label for="edit-note" class="svelte-112l7cd">Poznámka</label> <textarea id="edit-note" placeholder="Zadejte poznámku nebo komentář ke knize (nepovinné)" rows="5" class="svelte-112l7cd"></textarea></div> <div class="modal-actions svelte-112l7cd"><button type="submit" class="save-button svelte-112l7cd"><!></button> <button type="button" class="cancel-button svelte-112l7cd">Zrušit</button></div></form></div>',1),Da=N(`<div class="modal-backdrop svelte-112l7cd" role="button" tabindex="0" aria-label="Zrušit mazání knihy"></div> <div class="modal delete-confirm-modal svelte-112l7cd"><h3 class="svelte-112l7cd">Smazat knihu</h3> <p>Opravdu chcete smazat knihu <strong> </strong>?
      Tato akce nelze vrátit.</p> <div class="modal-actions svelte-112l7cd"><button class="delete-confirm-button svelte-112l7cd"><!></button> <button class="cancel-button svelte-112l7cd">Zrušit</button></div></div>`,1),Sa=N('<div class="books-container svelte-112l7cd"><h2 class="svelte-112l7cd">Seznam knih</h2> <!></div> <!> <!>',1);function Ca(_,l){la(l,!1);let e=Z([]),h=Z(!0),m=Z(null),p=null,n=Z(""),x=Z(""),g=Z(""),E=Z(!1),t=Z(!1),b=Z(null),r=Z(null),v=Z(!1);async function d(){try{i(h,!0),i(m,null),i(e,await da("/api/books"))}catch(s){i(m,s.message),i(e,[])}finally{i(h,!1)}}function X(s){p=s,i(n,s.title||""),i(x,s.author||""),i(g,s.note||""),i(E,!0),i(b,null)}function S(){i(E,!1),p=null}async function c(){if(!a(n).trim()){i(b,"Název knihy je povinný.");return}try{i(t,!0),i(b,null),await ca(p.id,{title:a(n),author:a(x)??void 0,note:a(g)??void 0});const s=a(e).findIndex(D=>D.id===p.id);s!==-1&&(va(e,a(e)[s]={...a(e)[s],title:a(n),author:a(x)||a(e)[s].author,note:a(g)}),i(e,[...a(e)])),S()}catch(s){i(b,s.message)}finally{i(t,!1)}}function A(s){i(r,s)}function J(){i(r,null)}async function F(s){try{i(v,!0),await ua(s),i(e,a(e).filter(D=>D.id!==s)),i(r,null)}catch(D){i(m,D.message)}finally{i(v,!1)}}ra(()=>{d()}),Pe();var M=Sa();Ce(s=>{ia.title="Čtenářský deník | Seznam knih"});var ee=oe(M),te=o(f(ee),2);{var le=s=>{var D=ma();w(s,D)},ce=(s,D)=>{{var V=I=>{var P=ba(),R=f(P),U=f(R);u(R);var z=o(R,2);u(P),G(()=>ae(U,`Došlo k chybě: ${a(m)??""}`)),C("click",z,d),w(I,P)},W=(I,P)=>{{var R=z=>{var O=ka();w(z,O)},U=z=>{var O=Ta(),Y=o(oe(O),2);_a(Y,5,()=>a(e),y=>y.id,(y,T)=>{var re=Ea(),se=f(re),ue=f(se,!0);u(se);var ie=o(se,2);{var k=q=>{var L=ga(),_e=f(L);u(L),G(()=>ae(_e,`Autor: ${a(T).author??""}`)),w(q,L)};H(ie,q=>{a(T).author&&q(k)})}var B=o(ie,2),fe=f(B);{var Me=q=>{var L=ya(),_e=f(L,!0);u(L),G(()=>ae(_e,a(T).note)),w(q,L)},Re=q=>{var L=xa();w(q,L)};H(fe,q=>{a(T).note?q(Me):q(Re,!1)})}u(B);var ke=o(B,2),ge=f(ke),Be=o(ge,2);u(ke),u(re),G(()=>ae(ue,a(T).title)),C("click",ge,()=>X(a(T))),C("click",Be,()=>A(a(T))),w(y,re)}),u(Y);var j=o(Y,2);{var K=y=>{var T=za();w(y,T)};H(j,y=>{a(e).length>5&&y(K)})}w(z,O)};H(I,z=>{a(e).length===0?z(R):z(U,!1)},P)}};H(s,I=>{a(m)?I(V):I(W,!1)},D)}};H(te,s=>{a(h)?s(le):s(ce,!1)})}u(ee);var ve=o(ee,2);{var Ie=s=>{var D=Aa(),V=oe(D),W=o(V,2),I=o(f(W),2);{var P=k=>{var B=wa(),fe=f(B,!0);u(B),G(()=>ae(fe,a(b))),w(k,B)};H(I,k=>{a(b)&&k(P)})}var R=o(I,2),U=f(R),z=o(f(U),2);ze(z),u(U);var O=o(U,2),Y=o(f(O),2);ze(Y),u(O);var j=o(O,2),K=o(f(j),2);He(K),u(j);var y=o(j,2),T=f(y),re=f(T);{var se=k=>{var B=de("Ukládám...");w(k,B)},ue=k=>{var B=de("Uložit");w(k,B)};H(re,k=>{a(t)?k(se):k(ue,!1)})}u(T);var ie=o(T,2);u(y),u(R),u(W),G(()=>{z.disabled=a(t),Y.disabled=a(t),K.disabled=a(t),T.disabled=a(t),ie.disabled=a(t)}),C("click",V,S),C("keydown",V,k=>k.key==="Escape"&&S()),be(z,()=>a(n),k=>i(n,k)),be(Y,()=>a(x),k=>i(x,k)),be(K,()=>a(g),k=>i(g,k)),C("click",ie,S),C("submit",R,oa(c)),w(s,D)};H(ve,s=>{a(E)&&s(Ie)})}var Ne=o(ve,2);{var Ze=s=>{var D=Da(),V=oe(D),W=o(V,2),I=o(f(W),2),P=o(f(I)),R=f(P);u(P),na(),u(I);var U=o(I,2),z=f(U),O=f(z);{var Y=y=>{var T=de("Mazání...");w(y,T)},j=y=>{var T=de("Smazat");w(y,T)};H(O,y=>{a(v)?y(Y):y(j,!1)})}u(z);var K=o(z,2);u(U),u(W),G(()=>{ae(R,`"${a(r).title??""}"`),z.disabled=a(v),K.disabled=a(v)}),C("click",V,J),C("keydown",V,y=>y.key==="Escape"&&J()),C("click",z,()=>F(a(r).id)),C("click",K,J),w(s,D)};H(Ne,s=>{a(r)&&s(Ze)})}w(_,M),sa()}export{Ca as component};
